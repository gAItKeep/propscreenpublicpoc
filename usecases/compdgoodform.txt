title Comprehensive Diagram

autonumber 1

actor LLM User
participant Web Client
participant Sensitive Info Check
participant LLM
participant Org SI Check
database Org PI
database Reports
actor Security Analyst

LLM User ->Web Client:User sends login request
alt Authentication Success
Web Client->LLM User: User granted access
else Authentication Failure
Web Client->LLM User:User denied access
LLM User->LLM User:User retries login attempt
end
LLM User->Web Client:User sends prompt
Web Client->Sensitive Info Check:prompt_forward_si()
Sensitive Info Check->Sensitive Info Check: prompt_log()
Sensitive Info Check->LLM: prompt_forward_llm()
LLM->Sensitive Info Check: <<LLM Response>>
Sensitive Info Check->Sensitive Info Check: response_si_scan()
alt No SI Detected
Sensitive Info Check->Web Client:return_clean_res()
Web Client->LLM User:User receives reply
else SI Detected
Sensitive Info Check->Org SI Check: promt_forward_org_check()
Org SI Check->Org PI:check_org_si()
alt False Positive
Org PI->Org SI Check: <<False>>
Org SI Check->Reports: send_false_pos()
Org SI Check->Web Client:return_false_pos()
Web Client->LLM User:User receives reply
else True Positive
Org PI->Org SI Check: <<True>>
Org SI Check->Reports: send_true_pos()
Org SI Check->Security Analyst:Send alert to security analyst
Org SI Check->Web Client:return_true_pos()
Web Client->LLM User:User receives warning
end
end 